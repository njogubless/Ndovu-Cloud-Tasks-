dist: jammy 
language: python
python:
  - "3.10.6"

before_script: pip install -r requirements.txt

script:
  - python manage.py test

services:
  - docker

before_script:
  - pip install docker

script:
  - docker build -t my-django-app .
  - docker run -d --name my-app-container my-django-app python manage.py runserver 0.0.0.0:8000

deploy:
  provider: script
  script: docker stop my-app-container
  on:
    branch: master
